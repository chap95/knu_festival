<!DOCTYPE html>
<html>
  <head>
    <title>KnuFestival</title>
    <%= csrf_meta_tags %>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <%= stylesheet_link_tag    'application', media: 'all'%>
    <%= javascript_include_tag 'application'%>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
  </head>

  <body>
    <%= render 'layouts/header'%>
    <div class='container'>
    <%= yield %>
    
    
    
    
    <!--플친 스크립트 코드-->
    <script>
      function msg_generate(data) {
      $('#test').append(`
      <div class="test" id="message${data.id}" style="display: none;position:absolute;">
        <div>${data.body}</div>    
      </div>`);
      var item = $(`#message${data.id}`);
      item.css('top',Math.round(Math.random()*700)+300);
      item.css('left',Math.round(Math.random()*500));
      item.fadeIn();
      
      setTimeout(function() {
        item.fadeOut();
      }, 4000);

    }

      var channel = pusher.subscribe('dashboard');
      channel.bind('create', function(data) {
        var msg = data.body;
        console.log(data);
        msg_generate(data);
      });
    </script>
  </body>
</html>
